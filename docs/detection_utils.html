---

title: detection_utils


keywords: fastai
sidebar: home_sidebar

summary: "utilities for loading `.weights` file and drawing of results for yolov3 hand detection model"
description: "utilities for loading `.weights` file and drawing of results for yolov3 hand detection model"
nb_path: "03_detection_utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_detection_utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table><tr>
<td> <img src="results/darknet/chart1.png" alt="Drawing" style="width: 100%;"/> </td>
<td> <img src="results/darknet/chart2.png" alt="Drawing" style="width: 100%;"/> </td>
<td> <img src="results/darknet/chart3.png" alt="Drawing" style="width: 100%;"/> </td>
</tr></table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="taken-from-here-with-some-methods-heavily-modified-in-the-following-cells">taken from <a href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/">here</a> with some methods heavily modified in the following cells<a class="anchor-link" href="#taken-from-here-with-some-methods-heavily-modified-in-the-following-cells"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>code to extract and rectify bounding boxes from yolov3 detection model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BoundBox" class="doc_header"><code>class</code> <code>BoundBox</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BoundBox</code>(<strong><code>xmin</code></strong>, <strong><code>ymin</code></strong>, <strong><code>xmax</code></strong>, <strong><code>ymax</code></strong>, <strong><code>objness</code></strong>=<em><code>None</code></em>, <strong><code>classes</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="decode_netout" class="doc_header"><code>decode_netout</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>decode_netout</code>(<strong><code>netout</code></strong>, <strong><code>anchors</code></strong>, <strong><code>obj_thresh</code></strong>, <strong><code>net_h</code></strong>, <strong><code>net_w</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="correct_yolo_boxes" class="doc_header"><code>correct_yolo_boxes</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>correct_yolo_boxes</code>(<strong><code>boxes</code></strong>, <strong><code>image_h</code></strong>, <strong><code>image_w</code></strong>, <strong><code>net_h</code></strong>, <strong><code>net_w</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bbox_iou" class="doc_header"><code>bbox_iou</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bbox_iou</code>(<strong><code>box1</code></strong>, <strong><code>box2</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="do_nms" class="doc_header"><code>do_nms</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>do_nms</code>(<strong><code>boxes</code></strong>, <strong><code>nms_thresh</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_image_pixels" class="doc_header"><code>load_image_pixels</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_image_pixels</code>(<strong><code>img_path</code></strong>, <strong><code>shape</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_boxes" class="doc_header"><code>get_boxes</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L136" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_boxes</code>(<strong><code>boxes</code></strong>, <strong><code>labels</code></strong>, <strong><code>thresh</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_yolov3_model" class="doc_header"><code>make_yolov3_model</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_yolov3_model</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="loading-yolov3-.weights-file">loading yolov3 <code>.weights</code> file<a class="anchor-link" href="#loading-yolov3-.weights-file"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightReader" class="doc_header"><code>class</code> <code>WeightReader</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L268" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightReader</code>(<strong><code>weight_file</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>helper method for loading detection and classification model and saving plots</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_model" class="doc_header"><code>load_model</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L329" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_model</code>(<strong><code>path</code></strong>, <strong><code>weights</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="generates-boxes,-and-alphabet-label-if-classifier-is-specified">generates boxes, and alphabet label if classifier is specified<a class="anchor-link" href="#generates-boxes,-and-alphabet-label-if-classifier-is-specified"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_boxes" class="doc_header"><code>generate_boxes</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L346" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_boxes</code>(<strong><code>image</code></strong>, <strong><code>v_boxes</code></strong>, <strong><code>v_labels</code></strong>, <strong><code>v_scores</code></strong>, <strong><code>figsize</code></strong>, <strong><code>save_dir</code></strong>, <strong><code>classifier</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="draws-the-above-results-and-saves-if-specfied">draws the above results and saves if specfied<a class="anchor-link" href="#draws-the-above-results-and-saves-if-specfied"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="wrapper-that-passes-intermediate-results-into-aforementioned-methods-and-draws-the-boxes">wrapper that passes intermediate results into aforementioned methods and draws the boxes<a class="anchor-link" href="#wrapper-that-passes-intermediate-results-into-aforementioned-methods-and-draws-the-boxes"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="draw_boxes" class="doc_header"><code>draw_boxes</code><a href="https://github.com/NicholasGoh/asl_detection/tree/master/asl_detection/detection/utils.py#L463" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>draw_boxes</code>(<strong><code>hand_detector</code></strong>, <strong><code>img_paths</code></strong>, <strong><code>save_dir</code></strong>=<em><code>None</code></em>, <strong><code>classifier</code></strong>=<em><code>None</code></em>, <strong><code>show_classes</code></strong>=<em><code>False</code></em>, <strong><code>class_threshold</code></strong>=<em><code>0.6</code></em>, <strong><code>nms_thresh</code></strong>=<em><code>0.6</code></em>, <strong><code>figsize</code></strong>=<em><code>(10, 10)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

